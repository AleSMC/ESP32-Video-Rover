[env:esp32cam]
platform = espressif32
board = esp32cam
framework = arduino

; --- Configuración de Hardware de Subida (Flasheo) ---
; Protocolo explícito para evitar ambigüedad en entornos con múltiples herramientas
upload_protocol = esptool
; Velocidad reducida para mitigar ruido en cables USB largos o adaptadores inestables
upload_speed = 115200

; --- Configuración del Monitor Serie ---
; Velocidad en baudios para la consola de depuración
monitor_speed = 115200
; Filtros de procesamiento de salida:
; - esp32_exception_decoder: Decodifica Backtrace en errores fatales (Crash dump)
; - time: Agrega marca de tiempo a cada línea de log
; - default: Mantiene el comportamiento estándar
monitor_filters = esp32_exception_decoder, time, default

; --- Gestión de Memoria y Particiones ---
; Esquema de particionado 'Huge App' (3MB APP / 1MB FS) requerido para stacks de video/WiFi
board_build.partitions = huge_app.csv
; Sistema de archivos LittleFS para almacenamiento eficiente no volátil
board_build.filesystem = littlefs

; --- Macros de Preprocesador y Configuración Global ---
build_flags = 
    ; Definición del modelo de hardware para la librería de cámara
    -D CAMERA_MODEL_AI_THINKER
    ; Nivel de depuración del núcleo (0 = Desactivado) para optimizar tiempos de ejecución
    -D CORE_DEBUG_LEVEL=0
    ; Definición centralizada del hostname mDNS (se usará como "rover.local")
    ; Se escapan las comillas para pasar como string literal al compilador C++
    -D MDNS_NAME=\"rover\"
    ; Permitir que las librerías en /lib vean los archivos de /include (como secrets.h)
    -I include

; --- Dependencias del Proyecto (Librerías) ---
lib_deps =
    ; Control PWM para servomotores
    madhephaestus/ESP32Servo @ ^3.0.5
    
    ; Stack de Red: mDNS, WiFi, TCP Asíncrono y Servidor Web
    ESPmDNS
    WiFi
    AsyncTCP
    ESPAsyncWebServer
    ArduinoJson

; --- Gestión de Conflictos de Dependencias ---
; Exclusión forzada de librerías incompatibles o deprecadas para evitar errores de enlazado
lib_ignore =
    RPAsyncTCP
    ESPAsyncTCP
    WebServer

[platformio]
; Estructura de directorios estándar
src_dir = src
include_dir = include